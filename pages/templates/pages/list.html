{%  extends 'pages/base.html' %}
{% load parse %}
{% load int_parse %}
{% block content %}

<style>

.table th,
.table td{	
	vertical-align: middle;
}

.a th,
.a td{
	border:1px;
}

</style>

<!-- risultati-->
<br>
<div class="row">
    <div class="col-md">
    
        <div class="card card-body">
            <h4>Ecco i risultati della tua ricerca:</h4><br>
            <p><font size="3">La lista completa degli attacchi appartenenti a questa categoria Ã¨ la seguente:</font></p>
        </div>
        
        <br>
        <div class="card">
            <table class="table">
            
                <tr>
                    <th width="32%">Name</th>
                    <th style="padding-left: 10px">Id</th>
                    <th style="padding-left: 30px">Abstraction</th>
                    <th>Related Attack Patterns</th>						
                    <th style="padding-left: 25px">Typical Severity</th>
                    <th style="padding-left: 25px">Likelihood of Attack</th>
                </tr>
                
                {% for i in object %}
                    <tr>
                        <td width="32%"><a href="/details/{{i.id}}/">{{i.name}}</a></td>
                        <td>{{i.id}}</td>
                        <td style="text-align:center; padding-right: 50px">{{i.abstraction}}</td>
                        
                        <td width="19%">
							{% if i.relatedattackpatterns != None %}
							
								<div class="card" style="width: 14rem">
									<table class='a'>
										<th>NATURE</th>								
									</table>
								</div>						
							
								{% for j in i.relatedattackpatterns|parse:"" %}
									
									{% with k=j|int_parse:"" %}
										<div class="card" style="width: 14rem;">
											<table class='a'>
												<td>													
													{{k.0}}&nbsp;<a href="/details/{{k.1}}/">{{k.1}}</a><br>													
												</td>
											</table>
										</div>	
									{% endwith %}
									
								{% endfor %}
							{% else %}
								<div class="card" style="width: 14rem;  height:55px">
									<table class="table">
										<td style="text-align:center;">None</td>										
									</table>
								</div>
							{% endif %}	
						</td>
                        
                        <td style="text-align:center; padding-right: 60px">{{i.typicalseverity}}</td>
                        <td style="text-align:center; padding-right: 75px">{{i.likelihoodofattack}}</td>
                    </tr>                                    
                {% endfor %}            
            
            </table>
            
        </div>
        
    </div>  
</div>

{% endblock content %}